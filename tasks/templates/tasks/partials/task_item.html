<div class="task-item {% if task.is_completed %}completed{% endif %}"
     data-task-id="{{ task.id }}"
     data-parent-id="{{ task.parent_id|default:'' }}"
     data-section-id="{{ task.section_id }}"
     style="padding-left: {{ depth|default:0|add:0 }}em;">
  <div class="task-row">
    {% if task.is_completed %}
    <button class="checkbox checked"
            hx-post="/tasks/{{ task.id }}/uncomplete/"
            hx-target="#center-panel"
            hx-swap="innerHTML">&#9745;</button>
    {% else %}
    <button class="checkbox"
            hx-post="/tasks/{{ task.id }}/complete/"
            hx-target="#center-panel"
            hx-swap="innerHTML">&#9744;</button>
    {% endif %}

    <span class="task-title"
          hx-get="/tasks/{{ task.id }}/detail/"
          hx-target="#detail-panel"
          hx-swap="innerHTML">{{ task.title }}</span>

    {% if task.due_date %}
    <span class="task-due-date">{{ task.due_date }}</span>
    {% endif %}

    {% for tag in task.tags.all %}
    <span class="task-tag">{{ tag.name }}</span>
    {% endfor %}
  </div>

  <div class="subtask-drop-zone sortable-tasks" data-section-id="{{ task.section_id }}" data-parent-task-id="{{ task.id }}">
    {% for subtask in task.subtasks.all %}
      {% if not subtask.is_completed %}
        {% include "tasks/partials/task_item.html" with task=subtask depth=depth|default:0|add:1 %}
      {% endif %}
    {% endfor %}
  </div>
</div>
